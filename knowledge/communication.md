# Vueç»„ä»¶é—´çš„é€šä¿¡ â˜ï¸

## 1. çˆ¶ç»„ä»¶ä¼ ç»™å­ç»„ä»¶

çˆ¶ç»„ä»¶é€šè¿‡ä½¿ç”¨v-bindå˜é‡æ¥å®ç°æ•°æ®çš„ä¼ å…¥

```js
// çˆ¶ç»„ä»¶
<Child :name="name" :clickFn="handleClick"/>
```

å­ç»„ä»¶é€šè¿‡å®ç°optionsä¸Šé¢çš„propsæ¥æ¥å—çˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„æ•°æ®

propsæ¥å—çº¦æŸæ•°æ®ï¼Œä¸‹é¢ç½—åˆ—äº†å››ç§æ–¹å¼ï¼š

```js
// æ–¹å¼1ï¼šç›´æ¥ä¼ é€’å˜é‡åï¼Œä¸åšä»»ä½•çš„ç±»å‹çº¦æŸä»¥åŠå€¼çº¦æŸ
props:['name','handleClick']


// æ–¹å¼2ï¼šä¼ é€’å˜é‡å + ç±»å‹çš„çº¦æŸ
props:{
  name: String,
  handleClick: Function
}

// æ–¹å¼3 ï¼šä¼ é€’å˜é‡å + å¤šä¸ªç±»å‹çš„çº¦æŸ
props:{
  name: [String, Number]
}

// æ–¹å¼4ï¼šä¼ é€’å˜é‡å + ç±»å‹çš„çº¦æŸ + é»˜è®¤å€¼
props:{ 
  name:{
    type:String,
    default: 'zhangshan'
  },
  handleClick:{
     type: Function,
     default: ()=>{}
  }
}
```

å¹¶ä¸”ä¸ºäº†ä¿è¯å•è¡Œæ•°æ®æµï¼Œä¸ä¼šé€ æˆå…¶ä»–å­ç»„ä»¶ä½¿ç”¨åˆ°çˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„æ•°æ®çš„å¼‚å¸¸ï¼Œè¦æ±‚å­ç»„ä»¶æ˜¯ä¸èƒ½å¤Ÿä¿®æ”¹propsçš„æ•°æ®çš„å€¼

## 2. å­ç»„ä»¶ä¼ ç»™çˆ¶ç»„ä»¶

vueçš„åŸå‹ä¸Šå®ç°äº†$emitçš„æ–¹æ³•ï¼Œç”¨æ¥åšäº‹ä»¶çš„å‘é€

å­ç»„ä»¶ä¼šé€šè¿‡$emitå‘é€äº‹ä»¶ç»™çˆ¶ç»„ä»¶ï¼Œçˆ¶ç»„ä»¶é€šè¿‡v-onçš„å½¢å¼æ¥ç›‘å¬å­ç»„ä»¶å‘é€æ¥çš„äº‹ä»¶

```js
// å­ç»„ä»¶
<button @click="$emit('onChildClick')">click me </button>

// çˆ¶ç»„ä»¶
<Child @onChildClick=â€œonChildClickâ€/>
```

å¦‚æœéœ€è¦ä¼ é€’å‚æ•°ï¼Œå¯ä»¥ç›´æ¥åœ¨$emitçš„ç¬¬äºŒä¸ªå‚æ•°å¤„å†™å…¥

```js
// å­ç»„ä»¶
<button @click="$emit('onChildClick', item)">click me </button>

// çˆ¶ç»„ä»¶
<Child @onChildClick=â€œonChildClickâ€/>

onChildClick(item){
  console.log('æˆ‘æ¥å—åˆ°äº†å­ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å‚æ•°å•¦ï¼', item)
}
```

## 3. çˆ¶ç»„ä»¶ä¸»åŠ¨è·å–å­ç»„ä»¶å®ä¾‹

refæ˜¯å¯ä»¥è®¾ç½®åœ¨å­ç»„ä»¶æ ‡ç­¾ä¸Šé¢çš„ä¸€ä¸ªå±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡this.$refs.childRefæ¥è·å–åˆ°å­ç»„ä»¶çš„å®ä¾‹ï¼Œä»è€Œä»å®ä¾‹ä¸Šé¢è°ƒç”¨å­ç»„ä»¶çš„å±æ€§æˆ–è€…æ–¹æ³•ï¼

```js
<Child ref="childRef"/>

this.$refs.childRef.onChildClick()
```

é™¤äº†refï¼Œè¿˜å¯ä»¥ä½¿ç”¨$childrenæ¥è·å–åˆ°å­ç»„ä»¶çš„å®ä¾‹ï¼Œä»è€Œä»å®ä¾‹ä¸Šé¢è°ƒç”¨å­ç»„ä»¶çš„å±æ€§æˆ–è€…æ–¹æ³•ï¼

```js
this.$children[0] // ç¬¬ä¸€ä¸ªå­©å­ç»„ä»¶
```

## 4. å­ç»„ä»¶ä¸»åŠ¨è·å–çˆ¶ç»„ä»¶çš„å®ä¾‹

åœ¨å­ç»„ä»¶å¯ä»¥é€šè¿‡this.$parentæ¥è·å–åˆ°çˆ¶ç»„ä»¶çš„å®ä¾‹ï¼Œä»è€Œä»å®ä¾‹ä¸Šé¢è°ƒç”¨å­ç»„ä»¶çš„å±æ€§æˆ–è€…æ–¹æ³•ï¼ç”¨æ³•åŒä¸Šã€‚

## 5. çˆ¶ç»„ä»¶ä¼ é€’åˆ°å­™ç»„ä»¶

- é»˜è®¤ä¼ é€’æ–¹æ³•(ä¾æ¬¡ä¼ é€’)

```js
// çˆ·çˆ·
<Parent :name="name" :age="age" :gender=â€œgenderâ€/>

// çˆ¶äº²
<Child :name="name" :age="age" :gender=â€œgenderâ€/>
props:['name', 'age', 'gender']

// å­™å­
<div>{{name}} - {{age}} - {{gender}}</div>
props:['name', 'age', 'gender']
```

- å½•éŸ³ç¬”ä¼ é€’ï¼ˆv-bind="$props" ä¼ é€’å…¨éƒ¨çš„propsï¼‰

```js
// çˆ·çˆ·
<Parent :name="name" :age="age" :gender=gender/>

// çˆ¸çˆ¸ propsæ¥å— && propsä¸€èµ·ä¼ 
<Child v-bind="$props"/>
props:['name', 'age', 'gender']

// å„¿å­ propsæ¥å—
<div>{{name}} - {{age}} - {{gender}}</div>
props:['name', 'age', 'gender']
```

ä½†çˆ¶ç»„ä»¶ä»ç„¶éœ€è¦å°†propsçš„å‚æ•°åˆ†è§£å‡ºæ¥å†ä¼ é€’ä¸‹å»ï¼Œç¨æ˜¾å¤æ‚

- v-bind="$attrs"çš„å…¶ä¸­ä¸€ä¸ªåŠŸèƒ½æ˜¯å¯ä»¥å®ç°ä¼ é€’ä¸åœ¨propsé‡Œé¢çš„å€¼

```js
// çˆ·çˆ·
<Parent :name="name" :age="age" :gender=gender/>

// çˆ¶äº²
<Child v-bind="$attrs"/>

// å„¿å­ propsæ¥å—
<div>{{name}} - {{age}} - {{gender}}</div>
props:['name', 'age', 'gender']
```

```js
// å„¿å­ props ä¸æ¥å—
<div>{{$attrs.name}} - {{$attrs.age}} - {{$attrs.gender}}</div>
```

## 6. å­™ç»„ä»¶ç»™çˆ¶ç»„ä»¶é€šä¿¡

å­™å­å…ˆæŠŠç”µè¯$emit('onChildClick')æ‰“ç»™äº†çˆ¸çˆ¸ï¼Œçˆ¸çˆ¸æ‹†è§£äº†å­™å­è¦è¯´çš„è¯ï¼Œå†æ‰“ç”µè¯ç»™çˆ·çˆ·@onChildClick="$emit('onChildClick')"

```js
// å„¿å­
<button @click="$emit('onChildClick')" @click="$emit('onChildClick1')">click me </button>

// çˆ¸çˆ¸
<Child @onChildClick="$emit('onChildClick')"  @onChildClick1="$emit('onChildClick1')"/>

// çˆ·çˆ·
<Parent @onChildClick="console.log('æˆ‘ç»ˆäºæ”¶åˆ°äº†å­™å­è¾ˆçš„ç‚¹å‡»äº‹ä»¶äº†ï¼')"  @onChildClick1="console.log('æˆ‘ç»ˆäºæ”¶åˆ°äº†å­™å­è¾ˆçš„ç‚¹å‡»äº‹ä»¶äº†1ï¼')"/>
```

- ä¸ºäº†ä¿è¯é€šè¯çš„å®‰å…¨æ€§ï¼Œv-on="$listeners"å¯ä»¥å®ç°äº‹ä»¶çš„æ‰“åŒ…ğŸ“¦

```js
// å„¿å­
<button @click="$emit('onChildClick')">click me </button>

// çˆ¸çˆ¸
<Child v-on=â€œ$listenersâ€/>
  
// çˆ·çˆ·
<Parent @onChildClick="console.log('æˆ‘ç»ˆäºæ”¶åˆ°äº†å­™å­è¾ˆçš„ç‚¹å‡»äº‹ä»¶äº†ï¼')"/>
```

## 7. è·¨å¤šå±‚é€šä¿¡

å½“æˆ‘ä»¬çš„ç»„ä»¶å±‚çº§æ›´æ·±çš„æ—¶å€™ï¼ŒA -> B -> C -> D -> E  -> F ï¼Œä¸Šé¢çš„æ–¹æ³•éƒ½æ˜¾å¾—ä¸å¤ªé€‚ç”¨äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ provide & inject æ¥å®ç°è·¨å±‚çº§çš„æ•°æ®ä¼ é€’ã€‚

çˆ¶ç»„ä»¶åªè¦å£°æ˜äº†provideï¼Œåœ¨å…¶å­ç»„ä»¶ï¼Œå­™ç»„ä»¶ï¼Œæ›¾å­™ç»„ä»¶ç­‰èƒ½å½¢æˆä¸Šä¸‹æ¸¸å…³ç³»çš„ç»„ä»¶ä¸­äº¤äº’ï¼Œæ— è®ºå¤šæ·±éƒ½èƒ½é€šè¿‡injectæ¥è®¿é—®providerä¸­çš„æ•°æ®ã€‚

```js
// æœ€ä¸Šé¢çš„ç»„ä»¶ elForm
provide(){
   return {elForm:this}  
}

// æœ€ä¸‹é¢çš„ç»„ä»¶ elFormItem
inject:['elForm']
```

## 8. å…„å¼Ÿç»„ä»¶ä¹‹é—´é€šä¿¡

æ¯”è¾ƒç´¯çš„åšæ³•ï¼šprops + emit + on

å…„å¼Ÿ1ç»„ä»¶emit -> çˆ¶ç»„ä»¶on -> å…„å¼Ÿ2ç»„ä»¶props

æœŸæœ›åšæ³•ï¼šå…„å¼Ÿ1ç»„ä»¶emitäº‹ä»¶ï¼Œå…„å¼Ÿ2ç»„ä»¶onäº‹ä»¶

- event bus

å…¨å±€EventBusï¼Œè™½ç„¶åœ¨æŸäº›ç¤ºä¾‹ä¸­ä¸æå€¡ä½¿ç”¨ï¼Œä½†å®ƒæ˜¯ä¸€ç§éå¸¸æ¼‚äº®ä¸”ç®€å•çš„æ–¹æ³•ï¼Œå¯ä»¥è·¨ç»„ä»¶ä¹‹é—´å…±äº«æ•°æ®ã€‚

    1.å®šä¹‰ä¸€ä¸ªç©ºçš„Vueå®ä¾‹ï¼Œä½œä¸ºä¸­å¤®äº‹ä»¶æ€»çº¿ã€‚

    2.Aç»„ä»¶å®šä¹‰æ–¹æ³•å»è§¦å‘è‡ªå®šä¹‰äº‹ä»¶

    3.Bç»„ä»¶åœ¨é’©å­é‡Œé¢å»ç›‘å¬

```js
var EventBus = new Vue();

this.$bus.$emit('call',{...});

this.$bus.$on('call',($event) => {...})
```

- vuex

Vuex æ˜¯ä¸€ä¸ªä¸“ä¸º Vue.js åº”ç”¨ç¨‹åºå¼€å‘çš„çŠ¶æ€ç®¡ç†æ¨¡å¼ã€‚å®ƒé‡‡ç”¨é›†ä¸­å¼å­˜å‚¨ç®¡ç†åº”ç”¨çš„æ‰€æœ‰ç»„ä»¶çš„çŠ¶æ€ï¼Œå¹¶ä»¥ç›¸åº”çš„è§„åˆ™ä¿è¯çŠ¶æ€ä»¥ä¸€ç§å¯é¢„æµ‹çš„æ–¹å¼å‘ç”Ÿå˜åŒ–ã€‚

```js
export default new Vuex.Store({
  state: {
    userInfo:{}
  },
  mutations: { // commit
    updateUserInfo (state,Object) {
       state.userInfo= Object
    }
  },
  actions: { // dispatch å‰¯ä½œç”¨
    getUserInfo(context){
    		// 1.å‘é€httpè¯·æ±‚ï¼Œæ‹¿åˆ°ç”¨æˆ·ä¿¡æ¯æ•°æ®
    		const userInfo = http()
    		
    		// 2.é€šè¿‡commitå‘é€mutationé‡Œé¢çš„æ–¹æ³•ä¿®æ”¹state
    		context.commit('updateUserInfo', userInfo)
    }
  },
  getters:{
    userInfo: state.userInfo
  }
})
```

## Vueç»„ä»¶é€šä¿¡æ–¹å¼æ€»ç»“ï¼š

### 1. prop &  this.$emit

propé€šä¿¡æ–¹å¼å¤§å®¶æœ€å¸¸è§çš„ï¼Œä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„çˆ¶å­ç»„ä»¶é€šä¿¡ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨æ ‡ç­¾é‡Œé¢ç»™å­ç»„ä»¶ç»‘å®šå±æ€§å’Œæ–¹æ³•ï¼Œå¯¹äºå±æ€§æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡å­ç»„ä»¶å£°æ˜çš„propæ‹¿åˆ°ï¼Œå¯¹äºçˆ¶å…ƒç´ çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ this.$emitè§¦å‘ã€‚

- çˆ¶ç»„ä»¶ï¼š

```js
<template>
  <div class="father" >
     <input  v-model="mes"   /> <button @click="send"  >å¯¹å­ç»„ä»¶è¯´</button>
     <div>å­ç»„ä»¶å¯¹æˆ‘è¯´ï¼š{{  sonMes  }}</div>
     <son :fatherMes="sendSonMes" @sonSay="sonSay"   />
  </div>
</template>
<script>
import son from './son'
export default {
   name:'father',
   components:{
       son /* å­ç»„ä»¶ */
   },
   data(){
       return {
          mes:'',
          sendSonMes:'', /* æ¥è‡ªå­ç»„ä»¶çš„ä¿¡æ¯ */
          sonMes:''      /* å‘é€ç»™å­ç»„ä»¶çš„ä¿¡æ¯  */
       } 
   },
   methods:{
      /* ä¼ é€’ç»™å­ç»„ä»¶ */
      send(){
          this.sendSonMes = this.mes
      },
      /* æ¥å—å­ç»„ä»¶ä¿¡æ¯ */ 
      sonSay(value){
          this.sonMes = value
      },
   },
}
</script>
```

æˆ‘ä»¬è¿™é‡Œåªéœ€è¦å°†ç»™å­ç»„ä»¶çš„æ•°æ®fatherMeså’Œæä¾›ç»™å­ç»„ä»¶çš„æ–¹æ³• sonSay é€šè¿‡æ ‡ç­¾æ–¹å¼ä¼ é€’ç»™å­ç»„ä»¶ã€‚

- å­ç»„ä»¶ï¼š

```js
<template>
    <div class="son" >
        <div> çˆ¶ç»„ä»¶å¯¹æˆ‘è¯´ï¼š{{ fatherMes  }} </div>
        <input  v-model="mes"   /> <button @click="send"  >å¯¹çˆ¶ç»„ä»¶è¯´</button>
    </div> 
</template>
<script>
export default {
   name:'son',
   props:{
      fatherMes:{
        type:String,
        default:''
      }
   },
   data(){
       return {
           mes:''
       }
   },
   methods:{
       send(){
           this.$emit('sonSay',this.mes)
       }
   },  
}
</script>
```

å­ç»„ä»¶é€šè¿‡propsæ¥å®šä¹‰æ¥å—çˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„ä¿¡æ¯,æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥é€šè¿‡thisè·å–åˆ°ï¼Œå¯¹äºçˆ¶ç»„ä»¶ä¼ é€’çš„äº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡this.$emitæ¥è§¦å‘äº‹ä»¶ã€‚

#### ä¼˜ç‚¹ï¼š

propsä¼ é€’æ•°æ®ä¼˜ç‚¹æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œçµæ´»ç®€å•ï¼Œå¯ä»¥å¯¹propsæ•°æ®è¿›è¡Œè®¡ç®—å±æ€§ï¼Œæ•°æ®ç›‘å¬ç­‰å¤„ç†ã€‚çˆ¶å­ç»„ä»¶é€šä¿¡çµæ´»æ–¹ä¾¿ã€‚è¿™é‡Œå¯èƒ½å•å•ä»…é™çˆ¶å­ä¸€å±‚ã€‚

#### ç¼ºç‚¹ï¼š 

1. propsç¯¡æ”¹ï¼šæˆ‘ä»¬åœ¨å­ç»„ä»¶ä¸­ä½¿ç”¨çˆ¶ç»„ä»¶propsçš„æ—¶å€™ï¼Œå¦‚æœæ¶‰åŠä¸€äº›å˜é‡èµ‹å€¼ï¼Œä¿®æ”¹ç­‰æ“ä½œï¼Œpropsè¢«è«åå…¶å¦™çš„ä¿®æ”¹äº†ï¼Œè¿åŒçˆ¶ç»„ä»¶çš„æ•°æ®ä¹Ÿè¢«ç¯¡æ”¹äº†ã€‚å¦‚æœpropsæ˜¯åŸºç¡€æ•°æ®ç±»å‹ï¼Œå½“æˆ‘ä»¬æ”¹å˜çš„æ—¶å€™ï¼Œå°±ä¼šæ›å‡ºé”™è¯¯ã€‚ä½†æ˜¯å½“æˆ‘ä»¬ä¼ è¿‡æ¥çš„æ˜¯ä¸€ä¸ªå¼•ç”¨æ•°æ®ç±»å‹ï¼Œå¹¶ä¸”ä¿®æ”¹æ•°æ®ä¸‹æŸä¸€ä¸ªå±æ€§çš„æ—¶å€™ã€‚å­ç»„ä»¶è™½ç„¶ä¸èƒ½ç›´æ¥å¯¹çˆ¶ç»„ä»¶propè¿›è¡Œé‡æ–°èµ‹å€¼ï¼Œä½†æ˜¯å½“çˆ¶ç»„ä»¶æ˜¯å¼•ç”¨ç±»å‹çš„æ—¶å€™ï¼Œå­ç»„ä»¶å¯ä»¥ä¿®æ”¹çˆ¶ç»„ä»¶çš„propsä¸‹é¢çš„å±æ€§ã€‚

2. è·¨å±‚çº§é€šä¿¡ï¼Œå…„å¼Ÿç»„ä»¶é€šè®¯å›°éš¾ï¼šå¯¹äºçˆ¶ç»„ä»¶-å­ç»„ä»¶-å­ç»„ä»¶çš„å­ç»„ä»¶è¿™ç§è·¨å±‚çº§çš„é€šä¿¡ï¼Œæ˜¾ç„¶éœ€è¦æˆ‘ä»¬ä¸€å±‚ä¸€å±‚çš„propç»‘å®šå±æ€§å’Œæ–¹æ³•ï¼Œå¦‚æœé‡åˆ°æ›´å¤æ‚çš„æƒ…å†µï¼Œå®ç°èµ·æ¥æ¯”è¾ƒå›°éš¾ã€‚å¯¹äºå…„å¼Ÿç»„ä»¶ä¹‹é—´çš„é€šè®¯ï¼Œpropséœ€è¦é€šè¿‡çˆ¶ç»„ä»¶ä½œä¸ºæ¡¥æ¢ï¼Œå®ç°å­ç»„ä»¶-> çˆ¶ç»„ä»¶ -> å­ç»„ä»¶é€šä¿¡æ¨¡å¼ï¼Œå¦‚æœæƒ³è¦é€šè¿‡çˆ¶ç»„ä»¶åšåª’ä»‹ï¼Œé‚£ä¹ˆå¿…å®šä¼šé€ æˆçˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œä¸ºäº†å®ç°å…„å¼Ÿç»„ä»¶é€šä¿¡ä»˜å‡ºçš„ä»£ä»·æ¯”è¾ƒå¤§ã€‚

#### åº”ç”¨åœºæ™¯

propsçš„åº”ç”¨åœºæ™¯å¾ˆç®€å•ï¼Œå°±æ˜¯æ­£å¸¸ä¸æ˜¯åµŒå¥—å¾ˆæ·±çš„çˆ¶å­ç»„ä»¶é€šä¿¡ï¼Œå’Œå…³ç³»ä¸æ˜¯å¾ˆå¤æ‚çš„å…„å¼Ÿç»„ä»¶ç»„ä»¶é€šä¿¡ã€‚

### 2. this.$xxx:

æˆ‘ä»¬æ‰€è°“çš„ç»„ä»¶ï¼Œæœ€ç»ˆéƒ½ä¼šæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå­˜æ”¾ç»„ä»¶çš„å„ç§ä¿¡æ¯,ç»„ä»¶å’Œç»„ä»¶é€šè¿‡this.$childrenå’Œthis.$parentæŒ‡é’ˆå…³è”èµ·æ¥ã€‚

å› ä¸ºåœ¨é¡¹ç›®ä¸­åªæœ‰ä¸€ä¸ªrootæ ¹ç»„ä»¶,ç†è®ºä¸Šï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°é€šè¿‡this.$children this.$parentæ¥è®¿é—®é¡µé¢ä¸Šçš„ä»»ä½•ä¸€ä¸ªç»„ä»¶ ï¼Œä½†æ˜¯å®é™…ä¸Šå¦‚ä½•ç²¾ç¡®åŒ¹é…åˆ°ç›®æ ‡ç»„ä»¶ï¼Œç¡®æ˜¯ä¸€ä¸ªæ— æ¯”æ£˜æ‰‹çš„é—®é¢˜ã€‚

- çˆ¶ç»„ä»¶

```js
<template>
  <div class="father" >
     <input  v-model="mes"   /> <button @click="send"  >å¯¹å­ç»„ä»¶è¯´</button>
     <son2 v-if="false" />
     <div>å­ç»„ä»¶å¯¹æˆ‘è¯´ï¼š{{  sonMes  }}</div>
     <son />
  </div>
</template>
<script>
import son from './son'
import son2 from './son2'
export default {
   name:'father',
   components:{
       son ,/* å­ç»„ä»¶ */
       son2
   },
   data(){
       return {
          mes:'',
          sendSonMes:'', /* æ¥è‡ªå­ç»„ä»¶çš„ä¿¡æ¯ */
          sonMes:''      /* å‘é€ç»™å­ç»„ä»¶çš„ä¿¡æ¯  */
       } 
   },
   methods:{
      /* ä¼ é€’ç»™å­ç»„ä»¶ */
      send(){
          /* å› ä¸ºsonç»„ä»¶æ˜¯ç¬¬ä¸€ä¸ªæœ‰æ•ˆç»„ä»¶æ‰€ä»¥ç›´æ¥å»ä¸‹æ ‡ä¸º0çš„ç»„ä»¶ */
          const currentChildren = this.$children[0]
          currentChildren.accept(this.mes)
      },
      /* æ¥æ”¶å­ç»„ä»¶çš„ä¿¡æ¯ */
      accept(value){
         this.sonMes = value
      }
      
   },
}
</script>
```

- å­ç»„ä»¶

```js
<template>
    <div class="son" >
        <div> çˆ¶ç»„ä»¶å¯¹æˆ‘è¯´ï¼š{{ fatherMes  }} </div>
        <input  v-model="mes"   /> <button @click="send"  >å¯¹çˆ¶ç»„ä»¶è¯´</button>
    </div> 
</template>
<script>
export default {
   name:'son',
   data(){
       return {
           mes:'',
           fatherMes:''
       }
   },
   methods:{
       /* æ¥å—çˆ¶ç»„ä»¶å†…å®¹ */
       accept(value){
         this.fatherMes = value
       },
       /* å‘çˆ¶ç»„ä»¶å‘é€ä¿¡æ¯ */
       send(){
           this.$parent.accept(this.mes)
       },
   },
}
</script>
```

æˆ‘ä»¬å¯ä»¥æ¸…æ¥šçœ‹åˆ°ï¼Œå’Œpropsé€šä¿¡ç›¸æ¯”ï¼Œthis.$parentï¼Œthis.$childrenæ˜¾å¾—æ›´åŠ ç®€æ´ï¼Œæ— éœ€å†ç»™å­ç»„ä»¶ç»‘å®šäº‹ä»¶å’Œå±æ€§ï¼Œåªéœ€è¦åœ¨çˆ¶ç»„ä»¶å’Œå­ç»„ä»¶å£°æ˜å‘é€å’Œæ¥å—æ•°æ®çš„æ–¹æ³•ã€‚å°±å¯ä»¥å®ç°ç»„ä»¶é—´çš„é€šä¿¡ï¼Œçœ‹èµ·æ¥å¾ˆæ˜¯ä¾¿æ·ï¼Œä½†æ˜¯å®é™…æ“ä½œä¸­ä¼šæœ‰å¾ˆå¤§çš„å¼Šç«¯ï¼Œè€Œä¸”vueæœ¬èº«ä¹Ÿä¸æå€¡è¿™ç§é€šä¿¡æ–¹å¼ã€‚è€Œä¸”è¿™ç§é€šä¿¡æ–¹å¼ä¹Ÿæœ‰å¾ˆå¤šé£é™©æ€§ï¼Œæˆ‘ä»¬ç¨åä¼šç»™äºˆè§£é‡Šã€‚

#### ä¼˜ç‚¹ï¼š

ç®€å•ï¼Œæ–¹ä¾¿ **this.$children,this.$parent this.$refs** è¿™ç§é€šä¿¡æ–¹å¼ï¼Œæ›´åŠ çš„ç®€å•ç›´æ¥è·å–vueå®ä¾‹ï¼Œå¯¹vueå®ä¾‹ä¸‹çš„æ•°æ®å’Œæ–¹æ³•ç›´æ¥è·å–æˆ–è€…å¼•ç”¨ã€‚

#### ç¼ºç‚¹ï¼š

1. $this.childrenä¸å¯æ§æ€§å¤§,æœ‰ä¸€å®šé£é™©ï¼šå¯¹äºv-ifåŠ¨æ€æ§åˆ¶ç»„ä»¶æ˜¾ç¤ºéšè—çš„ä¸å»ºè®®ç”¨this.$childrenç”¨æ³•ï¼Œå–è€Œä»£ä¹‹çš„æˆ‘ä»¬å¯ä»¥ç”¨refè·å–å¯¹åº”å­ç»„ä»¶çš„å®ä¾‹ã€‚

2. ä¸åˆ©äºç»„ä»¶åŒ–

3. å…„å¼Ÿç»„ä»¶æ·±å±‚æ¬¡åµŒå¥—ç»„ä»¶é€šè®¯å›°éš¾

#### åº”ç”¨åœºæ™¯ï¼š

ç›´æ¥é€šè¿‡å®ä¾‹è·å–çš„é€šä¿¡æ–¹å¼é€‚åˆå·²çŸ¥çš„ï¼Œå›ºå®šåŒ–çš„é¡µé¢ç»“æ„,è¿™ç§é€šè®¯æ–¹å¼ï¼Œè¦æ±‚çˆ¶å­ç»„ä»¶é«˜åº¦é€æ˜åŒ–ï¼ŒçŸ¥å·±çŸ¥å½¼ï¼Œå¾ˆæ˜ç¡®çˆ¶å­ç»„ä»¶æœ‰é‚£äº›æ–¹æ³•å±æ€§ï¼Œéƒ½æ˜¯ç”¨æ¥å¹²ä»€ä¹ˆã€‚æ‰€ä»¥è¯´è¿™ç§æ–¹å¼æ›´é€‚åˆé¡µé¢ç»„ä»¶ï¼Œè€Œä¸é€‚åˆä¸€äº›ç¬¬ä¸‰æ–¹ç»„ä»¶åº“ï¼Œæˆ–è€…æ˜¯å…¬å…±ç»„ä»¶ã€‚

### 3. provide inject

åœ¨çˆ¶ç»„ä»¶ä¸Šé€šè¿‡provideå°†æ–¹æ³•ï¼Œå±æ€§ï¼Œæˆ–è€…æ˜¯è‡ªèº«å®ä¾‹æš´éœ²å‡ºå»ï¼Œå­å­™ç»„ä»¶ï¼Œæ’æ§½ç»„ä»¶,ç”šè‡³æ˜¯å­å­™ç»„ä»¶çš„æ’æ§½ç»„ä»¶ï¼Œé€šè¿‡injectæŠŠçˆ¶è¾ˆprovideå¼•è¿›æ¥ã€‚æä¾›ç»™è‡ªå·±ä½¿ç”¨ï¼Œå¾ˆç»å…¸çš„åº”ç”¨ provideå’Œ injectçš„æ¡ˆä¾‹å°±æ˜¯ element-uiä¸­ el-formå’Œ el-form-item

#### åŸºæœ¬ç”¨æ³•ï¼š

æˆ‘ä»¬ç”¨çˆ¶ç»„ä»¶ -> å­ç»„ä»¶ -> å­™ç»„ä»¶ çš„æ¡ˆä¾‹

- çˆ¶ç»„ä»¶ï¼š

```js
<template>
  <div class="father" >
     <div>å­ç»„ä»¶å¯¹æˆ‘è¯´ï¼š{{  sonMes  }}</div>
     <div>å­™ç»„ä»¶å¯¹æˆ‘è¯´ï¼š{{  grandSonMes  }}</div>
     <son />
  </div>
</template>
<script>
import son from './son'
export default {
   name:'father',
   components:{
       son /* å­ç»„ä»¶ */
   },
   provide(){
       return {
           /* å°†è‡ªå·±æš´éœ²ç»™å­å­™ç»„ä»¶ ,è¿™é‡Œå£°æ˜çš„åç§°è¦äºå­ç»„ä»¶å¼•è¿›çš„åç§°ä¿æŒä¸€è‡´ */
           father:this
       }
   },
   data(){
       return {
          grandSonMes:'', /* æ¥è‡ªå­ç»„ä»¶çš„ä¿¡æ¯ */
          sonMes:''      /* å‘é€ç»™å­ç»„ä»¶çš„ä¿¡æ¯  */
       } 
   },
   methods:{
      /* æ¥å—å­™ç»„ä»¶ä¿¡æ¯ */
      grandSonSay(value){
          this.grandSonMes = value
      },
      /* æ¥å—å­ç»„ä»¶ä¿¡æ¯ */ 
      sonSay(value){
          this.sonMes = value
      },
   },
}
</script>
```

è¿™é‡Œæˆ‘ä»¬é€šè¿‡provideæŠŠæœ¬èº«æš´éœ²å‡ºå»ã€‚âš ï¸âš ï¸âš ï¸è¿™é‡Œå£°æ˜çš„åç§°è¦ä¸å­ç»„ä»¶å¼•è¿›çš„åç§°ä¿æŒä¸€è‡´

- å­ç»„ä»¶ï¼š 

```js
<template>
    <div class="son" >
        <input  v-model="mes"   /> <button @click="send"  >å¯¹çˆ¶ç»„ä»¶è¯´</button>
        <grandSon />
    </div> 
</template>

<script>
import  grandSon from './grandSon'
export default {
    /* å­ç»„ä»¶ */
   name:'son',
   components:{
       grandSon /* å­™ç»„ä»¶ */
   },
   data(){
       return {
           mes:''
       }
   },
   /* å¼•å…¥çˆ¶ç»„ä»¶ */
   inject:['father'],
   methods:{
       send(){
           this.father.sonSay(this.mes)
       }
   },
    
}
</script>
```

å­ç»„ä»¶é€šè¿‡injectæŠŠçˆ¶ç»„ä»¶å®ä¾‹å¼•è¿›æ¥ï¼Œç„¶åå¯ä»¥ç›´æ¥é€šè¿‡this.fatherå¯ä»¥ç›´æ¥è·å–åˆ°çˆ¶ç»„ä»¶ï¼Œå¹¶è°ƒç”¨ä¸‹é¢çš„sonSayæ–¹æ³•ã€‚

- å­™ç»„ä»¶

```js
<template>
   <div class="grandSon" >
        <input  v-model="mes"  /> <button @click="send"  >å¯¹çˆ·çˆ·ç»„ä»¶è¯´</button>
    </div> 
</template>

<script>
export default {
    /* å­™ç»„ä»¶ */
   name:'grandSon',
   /* å¼•å…¥çˆ·çˆ·ç»„ä»¶ */
   inject:['father'],
   data(){
       return {
           mes:''
       }
   },
   methods:{
       send(){
           this.father.grandSonSay( this.mes )
       }
   }
}
</script>
```

å­™ç»„ä»¶æ²¡æœ‰å¦‚ä½•æ“ä½œï¼Œå¼•å…¥çš„æ–¹æ³•å’Œå­ç»„ä»¶ä¸€è‡´ã€‚

#### æ’æ§½æ–¹å¼

provide , inject åŒæ ·å¯ä»¥åº”ç”¨åœ¨æ’æ§½ä¸Šï¼Œæˆ‘ä»¬ç»™çˆ¶å­ç»„ä»¶ç¨å¾®å˜åŠ¨ä¸€ä¸‹ã€‚

- çˆ¶ç»„ä»¶ï¼š

```js
<template>
  <div class="father" >
     <div>å­ç»„ä»¶å¯¹æˆ‘è¯´ï¼š{{  sonMes  }}</div>
     <div>å­™ç»„ä»¶å¯¹æˆ‘è¯´ï¼š{{  grandSonMes  }}</div>
     <son >
         <grandSon/>
     </son>
  </div>
</template>
<script>
import son from './slotSon'

import grandSon from './grandSon' 
export default {
   name:'father',
   components:{
       son, /* å­ç»„ä»¶ */
       grandSon /* å­™ç»„ä»¶ */
   },
   provide(){
       return {
           /* å°†è‡ªå·±æš´éœ²ç»™å­å­™ç»„ä»¶ */
           father:this
       }
   },
   data(){
       return {
          grandSonMes:'', /* æ¥è‡ªå­ç»„ä»¶çš„ä¿¡æ¯ */
          sonMes:''      /* å‘é€ç»™å­ç»„ä»¶çš„ä¿¡æ¯  */
       } 
   },
   methods:{
      /* æ¥å—å­™ç»„ä»¶ä¿¡æ¯ */
      grandSonSay(value){
          this.grandSonMes = value
      },
      /* æ¥å—å­ç»„ä»¶ä¿¡æ¯ */ 
      sonSay(value){
          this.sonMes = value
      },
   },
}
</script>
```

- å­ç»„ä»¶

```js
<template>
    <div class="son" >
        <input  v-model="mes"   /> <button @click="send"  >å¯¹çˆ¶ç»„ä»¶è¯´</button>
        <slot />
    </div> 
</template>
```

è¾¾åˆ°äº†åŒæ ·çš„é€šä¿¡æ•ˆæœã€‚å®é™…è¿™ç§æ’æ§½æ¨¡å¼,æ‰€åœ¨éƒ½åœ¨çˆ¶ç»„ä»¶æ³¨å†Œçš„ç»„ä»¶ï¼Œæœ€åå­™ç»„ä»¶ä¹Ÿä¼šç»‘å®šåˆ°å­ç»„ä»¶çš„childrenä¸‹é¢ã€‚å’Œä¸Šè¿°çš„æƒ…å†µå·®ä¸å¤šã€‚

#### å…¶ä»–ç”¨æ³•

provideä¸ä»…èƒ½æŠŠæ•´ä¸ªçˆ¶ç»„ä»¶å…¨éƒ¨æš´éœ²å‡ºå»ï¼Œä¹Ÿèƒ½æ ¹æ®éœ€è¦åªæš´éœ²ä¸€éƒ¨åˆ†ï¼ˆä¸€äº›çˆ¶ç»„ä»¶çš„å±æ€§æˆ–è€…æ˜¯çˆ¶ç»„ä»¶çš„æ–¹æ³•ï¼‰ï¼Œä¸Šè¿°çš„ä¾‹å­ä¸­ï¼Œåœ¨å­å­™ç»„ä»¶ä¸­ï¼Œåªç”¨åˆ°äº†çˆ¶ç»„ä»¶çš„æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åªæä¾›ä¸¤ä¸ªé€šä¿¡æ–¹æ³•ã€‚ä½†æ˜¯è¿™é‡Œæ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å‘å¤–æä¾›äº†æ–¹æ³•,å¦‚æœæ–¹æ³•é‡Œé¢æœ‰æ“ä½œthisè¡Œä¸ºï¼Œéœ€è¦ç»‘å®šthis

- çˆ¶ç»„ä»¶ï¼š

```js
   provide(){
       return {
           /* å°†é€šä¿¡æ–¹æ³•æš´éœ²ç»™å­å­™ç»„ä»¶(æ³¨æ„ç»‘å®šthis) */
           grandSonSay:this.grandSonSay.bind(this),
           sonSay:this.sonSay.bind(this)
       }
   },   
   methods:{
      /* æ¥å—å­™ç»„ä»¶ä¿¡æ¯ */
      grandSonSay(value){
          this.grandSonMes = value
      },
      /* æ¥å—å­ç»„ä»¶ä¿¡æ¯ */ 
      sonSay(value){
          this.sonMes = value
      },
   },
```

- å­ç»„ä»¶ï¼š

```js
/* å¼•å…¥çˆ¶ç»„ä»¶æ–¹æ³• */
   inject:['sonSay'],
   methods:{
       send(){
           this.sonSay(this.mes)
       }
   },
```

#### ä¼˜ç‚¹ï¼š

1. ç»„ä»¶é€šä¿¡ä¸å—åˆ°å­ç»„ä»¶å±‚çº§çš„å½±å“ï¼šprovide injectç”¨æ³• å’Œ react.contextéå¸¸ç›¸ä¼¼ï¼Œ provideç›¸å½“äºContext.Provider ,inject ç›¸å½“äº Context.Consumer,è®©çˆ¶ç»„ä»¶é€šä¿¡ä¸å—åˆ°ç»„ä»¶æ·±å±‚æ¬¡å­å­™ç»„ä»¶çš„å½±å“ã€‚

2. é€‚ç”¨äºæ’æ§½ï¼ŒåµŒå¥—æ’æ§½ï¼šprovide inject è®©æ’æ§½åµŒå¥—çš„çˆ¶å­ç»„ä»¶é€šä¿¡å˜å¾—ç®€å•ï¼Œè¿™å°±æ˜¯åˆšå¼€å§‹æˆ‘ä»¬è¯´çš„ï¼Œä¸ºä»€ä¹ˆ el-form å’Œ el-form-itemèƒ½å¤Ÿåè°ƒç®¡ç†è¡¨å•çš„çŠ¶æ€ä¸€æ ·ã€‚åœ¨elementæºç ä¸­ el-form å°±æ˜¯å°†thisæœ¬èº«provideå‡ºå»çš„ã€‚

#### ç¼ºç‚¹ï¼š

1. ä¸é€‚åˆå…„å¼Ÿé€šè®¯ï¼šprovide-inject åè°ƒä½œç”¨å°±æ˜¯è·å–çˆ¶çº§ç»„ä»¶ä»¬æä¾›çš„çŠ¶æ€ï¼Œæ–¹æ³•ï¼Œå±æ€§ç­‰ï¼Œæµå‘ä¸€ç›´éƒ½æ˜¯ç”±çˆ¶åˆ°å­ï¼Œprovideæä¾›å†…å®¹ä¸å¯èƒ½è¢«å…„å¼Ÿç»„ä»¶è·å–åˆ°çš„ï¼Œæ‰€ä»¥å…„å¼Ÿç»„ä»¶çš„é€šä¿¡ä¸è‚¯èƒ½é è¿™ç§æ–¹å¼æ¥å®Œæˆã€‚

2. çˆ¶çº§ç»„ä»¶æ— æ³•ä¸»åŠ¨é€šä¿¡ï¼šprovide-injectæ›´åƒçˆ¶äº²æŒ£é’±ç»™å„¿å­èŠ±ä¸€æ ·ï¼Œå„¿å­å¯ä»¥ä»çˆ¶äº²è¿™é‡Œæ‹¿åˆ°æä¾›çš„æ¡ä»¶ï¼Œä½†æ˜¯çˆ¶äº²å´æ— æ³•å‘å„¿å­ç´¢å–ä»»ä½•ä¸œè¥¿ã€‚æ­£å¦‚è¿™ä¸ªæ¯”æ–¹ï¼Œçˆ¶ç»„ä»¶å¯¹å­ç»„ä»¶çš„çŠ¶æ€ä¸€æ— æ‰€çŸ¥ã€‚ä¹Ÿä¸èƒ½ä¸»åŠ¨å‘å­ç»„ä»¶å‘èµ·é€šä¿¡ã€‚

#### åº”ç”¨åœºæ™¯

provide-injectè¿™ç§é€šä¿¡æ–¹å¼ï¼Œæ›´é€‚åˆæ·±å±‚æ¬¡çš„å¤æ‚çš„çˆ¶å­ä»£é€šä¿¡ï¼Œå­å­™ç»„ä»¶å¯ä»¥å…±äº«çˆ¶ç»„ä»¶çš„çŠ¶æ€ï¼Œè¿˜æœ‰ä¸€ç‚¹å°±æ˜¯é€‚åˆel-form el-form-itemè¿™ç§æ’æ§½ç±»å‹çš„æƒ…æ™¯ã€‚

### 4. vuex

vuexç®—æ˜¯vueä¸­å¤„ç†å¤æ‚çš„ç»„ä»¶é€šä¿¡çš„æœ€ä½³æ–¹æ¡ˆï¼Œæ¯•ç«Ÿæ˜¯vueå’Œvuexä¸€ä¸ªå¨˜èƒé‡Œå‡ºæ¥çš„ã€‚è€Œä¸”vuexåº•å±‚ä¹Ÿæ˜¯ç”¨vueå®ç°çš„ã€‚ç›¸ä¿¡ä¸å°‘åŒå­¦å¯¹vuexå¹¶ä¸é™Œç”Ÿã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹ä»‹ç»vuexã€‚

#### åŸºç¡€ç”¨æ³•

- vuexæ–‡ä»¶

```js
import Vuex from 'vuex'
import Vue from 'vue'

Vue.use(Vuex)

export default new Vuex.Store({
    state:{
        fatherMes:'',
        sonMes:'',
        fatherMesAsync:''
    },
    mutations:{
       sayFaher(state,value){
           state.fatherMes = value
       },
       saySon(state,value){
           state.sonMes = value
       },
       sayAsyncFather(state,value){
           state.fatherMesAsync = value
       }
    },
    actions:{
       asyncSayFather({ commit },payload){
           return new Promise((resolve)=>{
               setTimeout(()=>{
                   resolve(payload)
               },2000)
           }).then(res=>{
               commit('sayAsyncFather',res)
           })
       }
    }
})
```

åœ¨storeæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å£°æ˜ä¸‰ä¸ªmutations åˆ†åˆ«æ˜¯å‘çˆ¶ç»„ä»¶é€šä¿¡saySonï¼Œçˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡ï¼ŒåŒæ­¥æ–¹æ³•sayFaherå’Œå¼‚æ­¥æ–¹æ³•sayAsyncFather ,actionsä¸­æ¨¡æ‹Ÿäº†ä¸€ä¸ªä¸‰ç§’åæ‰§è¡Œçš„å¼‚æ­¥ä»»åŠ¡asyncSayFatherã€‚

- main.jsæ³¨å…¥store

```js
import store from './components/vuex/store'

new Vue({
  render: h => h(App),
  store
}).$mount('#app')
```

- çˆ¶ç»„ä»¶ï¼š

```js
<template>
  <div class="father" >
     <input  v-model="mes"   /> <button @click="send"  >åŒæ­¥ï¼šå¯¹å­ç»„ä»¶è¯´</button><br/>
      <input  v-model="asyncMes"   /> <button @click="asyncSend" >å¼‚æ­¥ï¼šå¯¹å­ç»„ä»¶è¯´</button><br/>
     <div>å­ç»„ä»¶å¯¹æˆ‘è¯´ï¼š{{  sonMes  }}</div>
     <son />
  </div>
</template>
<script>
import son from './son'
export default {
   /* çˆ¶ç»„ä»¶ */
   name:'father',
   components:{
       son ,/* å­ç»„ä»¶ */
   },
   data(){
       return {
          mes:'',
          asyncMes:''
       } 
   },
   computed:{
       sonMes(){
           return this.$store.state.sonMes
       }
   },
   mounted(){
       console.log(this.$store)
   },
   methods:{
      /* è§¦å‘mutationsï¼Œä¼ é€’æ•°æ®ç»™å­ç»„ä»¶ */
      send(){
        this.$store.commit('sayFaher',this.mes)
      },
      /* è§¦å‘actionsï¼Œä¼ é€’æ•°æ®ç»™å­ç»„ä»¶ */
      asyncSend(){
         this.$store.dispatch('asyncSayFather',this.asyncMes) 
      }
   },
}
</script>
```

çˆ¶ç»„ä»¶åˆ†åˆ«è§¦å‘åŒæ­¥å¼‚æ­¥æ–¹æ³•ï¼ŒæŠŠä¿¡æ¯å‘é€ç»™å­ç»„ä»¶ã€‚ç”¨computedæ¥æ¥å—vuexä¸­çš„stateã€‚

- å­ç»„ä»¶ï¼š

```js
<template>
    <div class="son" >
        <div> çˆ¶ç»„ä»¶å¯¹æˆ‘è¯´ï¼š{{ fatherMes  }} </div>
        <div> çˆ¶ç»„ä»¶å¯¹æˆ‘è¯´(å¼‚æ­¥)ï¼š{{ fatherMesAsync  }} </div>
        <input  v-model="mes"   /> <button @click="send"  >å¯¹çˆ¶ç»„ä»¶è¯´</button>
    </div> 
</template>
<script>
export default {
   name:'son',
   data(){
       return {
           mes:'',
       }
   },
   computed:{
       /* æ¥å—çˆ¶ç»„ä»¶åŒæ­¥æ¶ˆæ¯ */
       fatherMes(){
           return this.$store.state.fatherMes
       },
       /* æ¥å—çˆ¶ç»„ä»¶å¼‚æ­¥æ¶ˆæ¯ */
       fatherMesAsync(){
           return this.$store.state.fatherMesAsync
       }
   },
   methods:{
       /* å‘çˆ¶ç»„ä»¶å‘é€ä¿¡æ¯ */
       send(){
           this.$store.commit('saySon',this.mes)
       },
   },
    
}
</script>
```

#### ä¼˜ç‚¹ï¼š

1. æ ¹æœ¬è§£å†³å¤æ‚ç»„ä»¶çš„é€šä¿¡é—®é¢˜

2. æ”¯æŒå¼‚æ­¥ç»„ä»¶é€šä¿¡

vuexä¸­actionså…è®¸æˆ‘ä»¬åšä¸€äº›å¼‚æ­¥æ“ä½œï¼Œç„¶åé€šè¿‡commitå¯ä»¥æŠŠæ•°æ®ä¼ å…¥å¯¹åº”çš„mutation,è‡³äºactionsä¸ºä»€ä¹ˆå¯ä»¥æ‰§è¡Œå¼‚æ­¥ï¼Œæ˜¯å› ä¸ºé‡Œé¢åº•å±‚é€šè¿‡Promise.resolveèƒ½å¤Ÿè·å–å¼‚æ­¥ä»»åŠ¡å®Œæˆçš„çŠ¶æ€ã€‚

#### åº”ç”¨åœºæ™¯
å®é™…å¼€å‘åœºæ™¯ä¸­ï¼Œä¸ä¼šå­˜åœ¨demoé¡¹ç›®è¿™æ ·ç®€å•çš„é€šä¿¡ï¼Œvuexçš„å‡ºç°ï¼Œå°±æ˜¯è§£å†³è¿™äº›æ¯”è¾ƒå¤æ‚çš„ç»„ä»¶é€šä¿¡åœºæ™¯ã€‚å¯¹äºä¸­å¤§å‹é¡¹ç›®ï¼Œvuexæ˜¯å¾ˆä¸é”™çš„çŠ¶æ€ç®¡ç†ï¼Œæ•°æ®é€šä¿¡æ–¹æ¡ˆã€‚


### 5. äº‹ä»¶æ€»çº¿ä¸€ EventBus

EventBusäº‹ä»¶æ€»çº¿, EventBus æ‰€æœ‰äº‹ä»¶ç»Ÿä¸€è°ƒåº¦ï¼Œæœ‰ä¸€ä¸ªç»Ÿä¸€ç®¡ç†äº‹ä»¶ä¸­å¿ƒï¼Œä¸€ä¸ªç»„ä»¶ç»‘å®šäº‹ä»¶ï¼Œå¦ä¸€ä¸ªç»„ä»¶è§¦å‘äº‹ä»¶ï¼Œæ‰€æœ‰çš„ç»„ä»¶é€šä¿¡ä¸å†æ”¶åˆ°çˆ¶å­ç»„ä»¶çš„é™åˆ¶ï¼Œé‚£ä¸ªé¡µé¢éœ€è¦æ•°æ®ï¼Œå°±ç»‘å®šäº‹ä»¶ï¼Œç„¶åç”±æ•°æ®æä¾›è€…è§¦å‘å¯¹åº”çš„äº‹ä»¶æ¥æä¾›æ•°æ®ï¼Œè¿™ç§é€šè®¯åœºæ™¯ä¸ä»…ä»…åº”ç”¨åœ¨vue,è€Œä¸”ä¹Ÿåº”ç”¨åœ¨reactã€‚

EventBus æ ¸å¿ƒæ€æƒ³æ˜¯äº‹ä»¶çš„ç»‘å®šå’Œè§¦å‘ï¼Œè¿™ä¸€ç‚¹å’Œvueä¸­ this.$emit å’Œ this.$onä¸€æ ·ï¼Œè¿™ä¸ªä¹Ÿæ˜¯æ•´ä¸ªEventBusæ ¸å¿ƒæ€æƒ³ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ¥é‡ç‚¹è§£æè¿™ä¸ªæµç¨‹ã€‚

- EventBus

```js
export default class EventBus {
    es = {}
     /* ç»‘å®šäº‹ä»¶ */ 
    on(eventName, cb) {
        if (!this.es[eventName]) {
            this.es[eventName] = []
        }
        this.es[eventName].push({
            cb
        })
    }
    /* è§¦å‘äº‹ä»¶ */
    emit(eventName, ...params) {
        const listeners = this.es[eventName] || []
        let l = listeners.length

        for (let i = 0; i < l; i++) {
            const { cb } = listeners[i]
            cb.apply(this, params)
        }
    }
}

export default new EventBus()
```

- çˆ¶ç»„ä»¶ï¼š

```js
<template>
  <div class="father" >
     <input  v-model="mes"   /> <button @click="send"  >å¯¹å­ç»„ä»¶è¯´</button>
     <div>å­ç»„ä»¶å¯¹æˆ‘è¯´ï¼š{{  sonMes  }}</div>
     <son />
     <brotherSon />
  </div>
</template>
<script>
import son from './son'
import brotherSon from './brother'
import EventBus from './eventBus'
export default {
   name:'father',
   components:{
       son ,/* å­ç»„ä»¶ */
       brotherSon, /* å­ç»„ä»¶ */
   },
   data(){
       return {
          mes:'',
          sonMes:''/* å‘é€ç»™å­ç»„ä»¶çš„ä¿¡æ¯  */
       } 
   },
   mounted(){
      /* ç»‘å®šäº‹ä»¶ */
      EventBus.on('sonSay',this.sonSay)
   },
   methods:{
      /* ä¼ é€’ç»™å­ç»„ä»¶ */
      send(){
          EventBus.emit('fatherSay',this.mes)
      },
      /* æ¥å—å­ç»„ä»¶ä¿¡æ¯ */ 
      sonSay(value){
          this.sonMes = value
      },
   },
}
</script>
```

æˆ‘ä»¬åœ¨åˆå§‹åŒ–çš„æ—¶å€™é€šè¿‡EventBusçš„onæ–¹æ³•ç»‘å®šsonSayæ–¹æ³•ä¾›ç»™ç»™å­ç»„ä»¶ä½¿ç”¨ã€‚å‘å­ç»„ä»¶ä¼ é€’ä¿¡æ¯çš„æ—¶å€™ï¼Œé€šè¿‡emitè§¦å‘å­ç»„ä»¶çš„ç»‘å®šæ–¹æ³•ï¼Œå®ç°äº†çˆ¶å­é€šä¿¡ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹å­ç»„ä»¶ã€‚

- å­ç»„ä»¶ï¼š

```js
<template>
    <div class="son" >
        <div> çˆ¶ç»„ä»¶å¯¹æˆ‘è¯´ï¼š{{ fatherMes  }} </div>
        <input  v-model="mes"   /> <button @click="send"  >å¯¹çˆ¶ç»„ä»¶è¯´</button>
        <div>
            <input  v-model="brotherMes"   /> <button @click="sendBrother"  >å¯¹å…„å¼Ÿç»„ä»¶è¯´</button>
        </div>
    </div> 
</template>
<script>
import EventBus from './eventBus' 
export default {
   name:'son',
   data(){
       return {
           mes:'',
           brotherMes:'',
           fatherMes:''
       }
   },
   mounted(){
       /* ç»‘å®šäº‹ä»¶ */
       EventBus.on('fatherSay',this.fatherSay)
   },
   methods:{
       /* å‘çˆ¶ç»„ä»¶ä¼ é€’ä¿¡æ¯ */
       send(){
          EventBus.emit('sonSay',this.mes)
       },
       /* å‘å…„å¼Ÿç»„ä»¶ä¼ é€’ä¿¡æ¯ */
       sendBrother(){
          EventBus.emit('brotherSay',this.brotherMes)
       },
       /* çˆ¶ç»„ä»¶å¯¹æˆ‘è¯´ */
       fatherSay(value){
          this.fatherMes = value
       }
   },
    
}
</script>
```

å’Œçˆ¶ç»„ä»¶çš„é€»è¾‘å·®ä¸å¤šï¼ŒæŠŠéœ€è¦æ¥å—æ•°æ®çš„æ–¹æ³•ï¼Œé€šè¿‡EventBusç»‘å®šï¼Œé€šè¿‡è§¦å‘eventBusæ–¹æ³•ï¼Œæ¥å‘å¤–éƒ¨ä¼ é€’ä¿¡æ¯ã€‚æˆ‘ä»¬è¿˜æ¨¡æ‹Ÿäº†å…„å¼Ÿä¹‹é—´é€šä¿¡çš„åœºæ™¯ã€‚æˆ‘ä»¬å»ºç«‹ä¸€ä¸ªå…„å¼Ÿç»„ä»¶ã€‚

- å…„å¼Ÿç»„ä»¶

```js
<template>
  <div class="son" > å…„å¼Ÿç»„ä»¶å¯¹æˆ‘è¯´: {{ brotherMes  }} </div>
</template>

<script>

import EventBus from './eventBus'
export default {
   /* */
   name:'brother',
   data(){
       return {
          brotherMes:''
       }
   },
   mounted(){
       /* ç»‘å®šäº‹ä»¶ç»™å…„å¼Ÿç»„ä»¶ */
       EventBus.on('brotherSay',this.brotherSay)
   },
   methods:{
       brotherSay(value){
           this.brotherMes = value 
       }
   }

}
</script>
```
#### ä¼˜ç‚¹

1. ç®€å•çµæ´»ï¼Œçˆ¶å­å…„å¼Ÿé€šä¿¡ä¸å—é™åˆ¶ã€‚

eventBusçš„é€šä¿¡æ–¹å¼ï¼Œç›¸æ¯”ä¹‹å‰çš„å‡ ç§æ¯”è¾ƒç®€å•ï¼Œè€Œä¸”ä¸å—åˆ°ç»„ä»¶å±‚çº§çš„å½±å“ï¼Œå¯ä»¥å®ç°ä»»æ„ä¸¤ä¸ªç»„ä»¶çš„é€šä¿¡ã€‚éœ€è¦æ•°æ®å°±é€šè¿‡onç»‘å®šï¼Œä¼ é€’æ•°æ®å°±emitè§¦å‘ã€‚

2. é€šä¿¡æ–¹å¼ä¸å—æ¡†æ¶å½±å“

eventBusçš„é€šä¿¡æ–¹å¼ï¼Œä¸åªæ˜¯vueå¯ä»¥ç”¨ï¼Œreact,å°ç¨‹åºéƒ½å¯ä»¥ä½¿ç”¨è¿™ç§é€šä¿¡æ–¹å¼ï¼Œè€Œä¸”ç¬”è€…æ„Ÿè§‰è¿™ç§é€šä¿¡æ–¹å¼æ›´é€‚åˆå°ç¨‹åºé€šä¿¡ï¼Œè‡³äºä¸ºä»€ä¹ˆç¨åä¼šä¸€ä¸€é“æ¥ã€‚

#### ç¼ºç‚¹

1. ç»´æŠ¤å›°éš¾ï¼Œå®¹æ˜“å¼•èµ·è¿é”é—®é¢˜

å¦‚æœæˆ‘ä»¬é‡‡ç”¨äº‹ä»¶æ€»çº¿è¿™ç§é€šä¿¡æ¨¡å¼ï¼Œå› ä¸ºæ‰€æœ‰äº‹ä»¶æ˜¯é«˜åº¦é›†ä¸­ï¼Œç»Ÿä¸€ç®¡ç†çš„ï¼Œä¸­é—´å¦‚æœæœ‰ä¸€ä¸ªç¯èŠ‚å‡ºç°é”™è¯¯ï¼Œå°±ä¼šé€ æˆç‰µä¸€å‘åŠ¨å…¨èº«çš„ç¾éš¾.è€Œä¸”åæœŸç»´æŠ¤ä¹Ÿæ˜¯ååˆ†å›°éš¾çš„ã€‚

2. éœ€è¦è°¨å°æ…å¾®çš„å‘½ä»¤è§„èŒƒ

ç°å®çš„åº”ç”¨åœºæ™¯ï¼Œè¦æ¯”demoåœºæ™¯å¤æ‚çš„å¤šï¼Œå®é™…åœºæ™¯ä¼šæœ‰æ— æ•°å¯¹çˆ¶å­ç»„ä»¶ï¼Œæ— æ•°å¯¹å…„å¼Ÿç»„ä»¶ï¼Œæˆ‘ä»¬ä¸è‚¯èƒ½æ¯ä¸ªäº‹ä»¶éƒ½å«ç›¸åŒåå­—ï¼Œæ‰€ä»¥eventBusç»‘å®šäº‹ä»¶çš„å‘½åè¦æœ‰ä¸¥æ ¼çš„è§„èŒƒï¼Œä¸èƒ½èµ·é‡å¤åå­—ï¼Œä¹Ÿä¸èƒ½ç”¨é”™åå­—ã€‚

3. ä¸åˆ©äºç»„ä»¶åŒ–å¼€å‘

eventBusé€šä¿¡æ–¹å¼æ˜¯æ— æ³•è¿›è¡Œæœ‰æ•ˆçš„ç»„ä»¶åŒ–å¼€å‘çš„ï¼Œå‡è®¾ä¸€ä¸ªåœºæ™¯ï¼Œä¸€ä¸ªé¡µé¢ä¸Šæœ‰å¤šä¸ªå…¬å…±ç»„ä»¶ï¼Œæˆ‘ä»¬åªè¦å‘å…¶ä¸­çš„ä¸€ä¸ªä¼ é€’æ•°æ®ï¼Œä½†æ˜¯æ¯ä¸ªå…¬å…±ç»„ä»¶éƒ½ç»‘å®šäº†æ•°æ®æ¥å—çš„æ–¹æ³•ã€‚æˆ‘ä»¬æ€ä¹ˆæ ·åšåˆ°æŠŠæ•°æ®ä¼ é€’ç»™éœ€è¦çš„ç»„ä»¶å‘¢ï¼Ÿ

#### åº”ç”¨åœºæ™¯

å®ç°æ€»çº¿è¿™ç§æ–¹å¼æ›´é€‚åˆï¼Œå¾®ä¿¡å°ç¨‹åºï¼Œå’ŒåŸºäºvueæ„å»ºçš„å°ç¨‹åºï¼Œè‡³äºä¸ºä»€ä¹ˆå‘¢ï¼Œå› ä¸ºæˆ‘ä»¬éƒ½çŸ¥é“å°ç¨‹åºé‡‡ç”¨åŒçº¿ç¨‹æ¨¡å‹ï¼ˆæ¸²æŸ“å±‚+é€»è¾‘å±‚ï¼‰ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ï¼Œæ¸²æŸ“å±‚ä½œç”¨å°±æ˜¯å°ç¨‹åºwxmlæ¸²æŸ“åˆ°æˆ‘ä»¬çš„è§†çº¿ä¸­ï¼Œè€Œé€»è¾‘å±‚å°±æ˜¯æˆ‘ä»¬å†™çš„ä»£ç é€»è¾‘ï¼Œåœ¨æ€§èƒ½ä¸Šï¼Œæˆ‘ä»¬è¦çŸ¥é“åœ¨æ¸²æŸ“å±‚æµªè´¹çš„æ€§èƒ½è¦è¿œå¤§äºé€»è¾‘å±‚çš„ä»£ç æ‰§è¡Œæ€§èƒ½å¼€é”€ï¼Œå¦‚æœæˆ‘ä»¬åœ¨å°ç¨‹åºé‡Œé‡‡ç”¨é€šè¿‡propsç­‰ä¼ é€’æ–¹å¼ï¼Œå±æ€§æ˜¯ç»‘å®šåœ¨å°ç¨‹åºæ ‡ç­¾é‡Œé¢çš„ï¼Œæ‰€ä»¥åŠ¿å¿…è¦é‡æ–°æ¸²æŸ“è§†å›¾å±‚ã€‚å¦‚æœé¡µé¢ç»“æ„å¤æ‚ï¼Œå¯èƒ½ä¼šé€ æˆå¡é¡¿ç­‰æƒ…å†µï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡eventBuså¯ä»¥ç»•è¿‡æ¸²æŸ“å±‚ï¼Œç›´æ¥æœ‰é€»è¾‘å±‚è®²æ•°æ®è¿›è¡Œæ¨é€ï¼ŒèŠ‚çº¦äº†æ€§èƒ½çš„å¼€é”€ã€‚

### 6. äº‹ä»¶æ€»çº¿äºŒ new Vue

new Vue è¿™ç§é€šä¿¡æ–¹å¼å’ŒeventBuså¤§è‡´å·®ä¸å¤šï¼Œæœ‰ä¸€ç‚¹ä¸åŒçš„æ˜¯ï¼Œä»¥vueå®ä¾‹ä½œä¸ºeventBusä¸­å¿ƒï¼Œé™¤äº†æˆ‘ä»¬å¯ä»¥ç”¨$on,$emitä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨vueä¸‹çš„data,watchç­‰æ–¹æ³•ï¼Œè€Œä¸”æˆ‘ä»¬å»ºç«‹å¤šä¸ªå¤šä¸ªvueï¼Œä½œä¸ºä¸åŒæ¨¡å—çš„æ•°æ®é€šä¿¡æ¡¥æ¢ï¼Œç›¸æ¯”ä¸Šè¾¹é‚£ä¸ªEventBusæ–¹æ³•ï¼Œnew Vueè¿™ç§æ–¹æ³•æ›´é«˜æ•ˆ,æ›´é€‚åˆvueé¡¹ç›®åœºæ™¯ã€‚æˆ‘ä»¬æ¥ç€å¾€ä¸‹çœ‹ã€‚

- VueBus

```js
import Vue from 'vue'

export default new Vue()
```

- çˆ¶ç»„ä»¶

```js
<template>
  <div class="father" >
     <input  v-model="mes"   /> <button @click="send"  >å¯¹å­ç»„ä»¶è¯´</button>
     <div>å­ç»„ä»¶å¯¹æˆ‘è¯´ï¼š{{  sonMes  }}</div>
     <son />
  </div>
</template>
<script>
import son from './son'
import VueBus from './vueBus'
export default {
   /* çˆ¶ç»„ä»¶ */ 
   name:'father',
   components:{
       son ,/* å­ç»„ä»¶ */
   },
   data(){
       return {
          mes:'',
          sonMes:'' /* å‘é€ç»™å­ç»„ä»¶çš„ä¿¡æ¯  */
       } 
   },
   created(){
       /* ç»‘å®šå±æ€§ */
       VueBus._data.mes = 'hello,world'
   },
   mounted(){
      /* ç»‘å®šäº‹ä»¶ */
      VueBus.$on('sonSay',this.sonSay)
   },
   methods:{
      /* ä¼ é€’ç»™å­ç»„ä»¶ */
      send(){
         VueBus.$emit('fatherSay',this.mes)
      },
      /* æ¥å—å­ç»„ä»¶ä¿¡æ¯ */ 
      sonSay(value){
          this.sonMes = value
      },
   },
}
</script>
```

æˆ‘ä»¬é€šè¿‡ $onç»‘å®šäº†æ¥å—æ•°æ®çš„æ–¹æ³•ï¼Œåˆå§‹åŒ–çš„æ—¶å€™å‘ vue_dataä¸‹é¢ç»‘å®šäº†æ•°æ®ã€‚

- å­ç»„ä»¶ï¼š

```js
<template>
    <div class="son" >
        <div> çˆ¶ç»„ä»¶å¯¹æˆ‘è¯´ï¼š{{ fatherMes  }} </div>
        <input  v-model="mes"   /> <button @click="send"  >å¯¹çˆ¶ç»„ä»¶è¯´</button><br/>
        <button @click="getFatherMes" >è·å–æ•°æ®</button>
    </div> 
</template>

<script>
import VueBus from './vueBus' 
export default {
   name:'son',
   data(){
       return {
           mes:'',
           brotherMes:'',
           fatherMes:''
       }
   },
   mounted(){
       /* ç»‘å®šäº‹ä»¶ */
       VueBus.$on('fatherSay',this.fatherSay)
   },
   methods:{
       /* å‘çˆ¶ç»„ä»¶ä¼ é€’ä¿¡æ¯ */
       send(){
          VueBus.$emit('sonSay',this.mes)
       },
       /* çˆ¶ç»„ä»¶å¯¹æˆ‘è¯´ */
       fatherSay(value){
          this.fatherMes = value
       },
       /* è·å–çˆ¶ç»„ä»¶å­˜å…¥vueä¸­çš„æ•°æ® */
       getFatherMes(){
           console.log( VueBus._data.mes )
       }
   },

    
}
</script>
```

å’ŒeventBusäº‹ä»¶æ€»çº¿ä¸€æ ·,æˆ‘ä»¬è¿˜å¯ä»¥ç›´æ¥é€šè¿‡_dataæ•°æ®ç›´æ¥è·å–åˆ°çˆ¶ç»„ä»¶ä¼ é€’çš„å†…å®¹ã€‚

#### ä¼˜ç‚¹

1. ç®€å•çµæ´»ï¼Œä»»æ„ç»„ä»¶ä¹‹é—´é€šä¿¡ã€‚

å’Œä¸Šè¾¹eventBusé€šä¿¡æ–¹å¼ä¸€æ ·ï¼Œè¿™ç§é€šä¿¡æ–¹å¼å¾ˆçµæ´»ï¼Œå¯ä»¥è½»æ¾åœ¨ä»»æ„ç»„ä»¶é—´å®ç°é€šä¿¡ã€‚

2. é™¤äº†é€šä¿¡è¿˜å¯ä»¥ä½¿ç”¨watch  , computedç­‰æ–¹æ³•

å¦‚æœæˆ‘ä»¬é€šè¿‡vueä½œä¸ºé€šä¿¡åª’ä»‹ï¼Œé‚£ä¹ˆåªç”¨å…¶ä¸­çš„$emitå’Œ$onçœŸçš„æ˜¯æœ‰ç‚¹å¤§æå°ç”¨äº†ï¼Œæ—¢ç„¶å®ä¾‹äº†ä¸€ä¸ªvueï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾çš„ä½¿ç”¨vueçš„ $watch computedç­‰åŠŸèƒ½ã€‚

#### ç¼ºç‚¹

åŸºæœ¬ä¸ŠEventBusçš„ç¼ºç‚¹ï¼Œéƒ½åœ¨vueè¿™ç§é€šä¿¡æ–¹å¼ä¸­éƒ½æœ‰å­˜åœ¨ã€‚

#### åº”ç”¨åœºæ™¯

åœ¨é¡¹ç›®ä¸­ä¸è€ƒè™‘ç”¨vuexçš„ä¸­å°å‹é¡¹ç›®ä¸­ï¼Œå¯ä»¥è€ƒè™‘é‡‡ç”¨vueäº‹ä»¶æ€»çº¿è¿™ç§é€šä¿¡æ–¹å¼ï¼Œåœ¨ä½¿ç”¨çš„è¿™ç§æ–¹å¼çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸€å®šè¦æ³¨æ„å‘½åç©ºé—´ï¼Œä¸è¦é‡å¤ç»‘å®šäº‹ä»¶åç§°ã€‚åˆ†æ¸…æ¥šä¸šåŠ¡æ¨¡å—ï¼Œé¿å…åç»­ç»´æŠ¤å›°éš¾ã€‚

