# vue-cli-demo

## Project setup
```
yarn install
```

### Compiles and hot-reloads for development
```
yarn serve
```

### Compiles and minifies for production
```
yarn build
```

### Lints and fixes files
```
yarn lint
```

### Customize configuration
See [Configuration Reference](https://cli.vuejs.org/config/).


## Eslinté…ç½®

- é¦–å…ˆæˆ‘ä»¬å¾—åœ¨é¡¹ç›®æ ¹ç›®å½•å»ºç«‹ä¸€ä¸ª  .eslintrc.js æ–‡ä»¶ï¼Œé‡Œé¢é…ç½®ç›¸å…³çš„è§„åˆ™ï¼Œè¿™è¾¹æˆ‘å‘å‡ºå¹³æ—¶æˆ‘è‡ªå·±ç”¨çš„ ğŸ‘‰Elisntè§„åˆ™ å§ï¼Œé‡‡ç”¨çš„æ˜¯èŠ±è£¤è¡©çš„è§„åˆ™ï¼ˆæˆ‘å¾ˆå¤šä¸œè¥¿éƒ½æ˜¯ä»ä»–é¡¹ç›®é‡Œå­¦æ¥çš„ï¼Œæ„Ÿè°¢å¤§ä½¬ï¼‰ï¼Œå½“ç„¶æƒ³è¦äº†è§£æ›´è¯¦ç»†çš„é…ç½®è¯´æ˜å¯ä»¥çœ‹è¿™é‡Œ ğŸ‘‰eslinté…ç½®è¯´æ˜

- å†å»ºç«‹ä¸€ä¸ª ğŸ‘‰.eslintignore æ–‡ä»¶ï¼Œå¯ä»¥è®¾ç½®eslintçš„å¿½ç•¥æ–‡ä»¶/æ–‡ä»¶å¤¹

- æ¥ä¸‹æ¥å°±æ˜¯é‡å¤´æˆäº†ï¼Œé…ç½®æˆ‘ä»¬çš„VsCodeç¼–è¯‘å™¨ï¼Œæ¥è¾¾åˆ°å¤±å»ç„¦ç‚¹å°±è‡ªåŠ¨æŒ‰ç…§ç›¸å…³è§„åˆ™æ ¼å¼åŒ–ï¼Œé¦–å…ˆä½ å¾—å®‰è£…VsCodeæ’ä»¶ï¼ˆeslintï¼Œprettierï¼‰ï¼Œç„¶ååœ¨å·¥ä½œåŒºè®¾ç½®setting.jsonï¼ˆå»ºè®®åœ¨å·¥ä½œåŒºé…ç½®ï¼Œæ¯•ç«Ÿæ¯ä¸ªé¡¹ç›®éƒ½æœ‰ä¸åŒçš„è§„åˆ™å§ï¼‰ï¼Œæ·»åŠ å¦‚ä¸‹é…ç½®

```js
{Â 
    "files.autoSave":Â "onFocusChange",Â Â 
    "editor.codeActionsOnSave":Â {Â Â Â Â 
        "source.fixAll.eslint":Â trueÂ Â 
    }
}
```

## é…ç½®ç¯å¢ƒå˜é‡å’Œæ¨¡å¼

ç›¸ä¿¡å¾ˆå¤šå°ä¼™ä¼´çš„è¯·æ±‚APIçš„åœ°å€å¤§è‡´åº”è¯¥æœ‰ä¸¤ä¸ªå§ï¼Œä¸€ä¸ªæ˜¯å¼€å‘è¿‡ç¨‹ä¸­ç”¨çš„æµ‹è¯•æ¥å£ï¼Œä¸€ä¸ªæ˜¯æ‰“åŒ…ä¸Šçº¿çš„æ­£å¼æ¥å£ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¥½äº›æ—¶å€™å¯èƒ½æ‰“åŒ…çš„æ—¶å€™ä¼šå¿˜è®°æ›¿æ¢æ¥å£æ€ä¹ˆåŠå‘¢ï¼Œè™½ç„¶å¾ˆå¤šæ—¶å€™åªéœ€è¦Nginxåå‘ä»£ç†ä¸€ä¸‹å°±å¥½äº†ï¼Œä½†æ˜¯ä¼šå‡ºç°åœ¨è¿™ä¸ªé—®é¢˜ï¼Œå‡è®¾æµ‹è¯•è¯·æ±‚åœ°å€æ˜¯  http://127.0.0.1:4000/aï¼Œæ­£å¼è¯·æ±‚åœ°å€æ˜¯  http://127.0.0.1:4000/a/bï¼Œé…ç½®Nginxçš„äººåªä»£ç†äº†  http://127.0.0.1:4000/aï¼Œé‚£æ­£å¼ç¯å¢ƒå°±GGäº†ï¼Œè¯·æ±‚ä¸åˆ°bå•Šï¼Œå½“ç„¶è¿™æ˜¯ä¸ä¸“ä¸šæƒ…å†µï¼Œä¸“ä¸šçš„éƒ½æ²¡é—®é¢˜çš„ï¼Œæœ¬æ¬¡å°±æ¥å¤„ç†ç¢°åˆ°ä¸ä¸“ä¸šçš„åŒäº‹è¯¥æ€ä¹ˆè§£å†³é—®é¢˜ã€‚å‰é¢åªæ˜¯ä¸ªğŸŒ°ï¼Œé…ç½®ç¯å¢ƒå˜é‡å’Œæ¨¡å¼è¿˜æ˜¯å¯ä»¥å¹²å¾ˆå¤šäº‹æƒ…çš„

- é¦–å…ˆæˆ‘ä»¬å¾—å»äº†è§£ ğŸ‘‰ç¯å¢ƒå˜é‡å’Œæ¨¡å¼ æ˜¯æ€ä¹ˆç»™ç†è§£çš„ä»¥åŠå¦‚ä½•é…ç½®åŠæ³¨æ„å“ªäº›ç»†èŠ‚

- åˆ›å»ºå‡ ä¸ªenvæ–‡ä»¶ï¼ˆå½“ç„¶å¯ä»¥æ ¹æ®å®é™…æƒ…å†µåˆ›å»ºå¤šä¸ªï¼‰

```js
.env.devÂ Â Â Â Â Â Â Â Â Â Â Â 
#Â åªåœ¨å¼€å‘ç¯å¢ƒä¸­è¢«è½½å…¥Â Â Â Â 
#Â ä»¥ä¸‹æ˜¯Â .env.devÂ é‡Œé¢çš„å†…å®¹Â Â Â Â 
NODE_ENVÂ =Â developmentÂ Â Â Â 
#Â æŒ‡å®šæ‰§è¡Œç¯å¢ƒÂ Â Â Â 
ENVÂ =Â 'dev'Â Â 
#Â æŒ‡å®šæ‰§è¡Œè„šæœ¬çš„Â modeÂ Â Â Â V
UE_APP_BASE_APIÂ =Â 'http://127.0.0.1:4000/a'Â Â 
#Â æŒ‡å®šè¯·æ±‚çš„æ¥å£Â Â Â Â 

.env.build_testÂ Â Â Â Â 
#Â åªåœ¨æ‰“åŒ…æµ‹è¯•ç¯å¢ƒè¢«è½½å…¥Â Â Â Â 
#Â ä»¥ä¸‹æ˜¯Â .env.build_testÂ é‡Œé¢çš„å†…å®¹Â Â Â Â 
NODE_ENVÂ =Â productionÂ Â Â Â 
ENVÂ =Â 'build_test'Â Â Â Â 
VUE_APP_BASE_APIÂ =Â 'http://127.0.0.1:4000/a'Â Â Â Â .

env.build_prodÂ Â Â Â Â 
#Â åªåœ¨æ‰“åŒ…æ­£å¼ç¯å¢ƒè¢«è½½å…¥Â Â Â Â 
#Â ä»¥ä¸‹æ˜¯Â .env.build_prodÂ é‡Œé¢çš„å†…å®¹Â Â Â Â 
NODE_ENVÂ =Â productionÂ Â Â Â 
ENVÂ =Â 'build_prod'Â Â Â Â 
VUE_APP_BASE_APIÂ =Â 'http://127.0.0.1:4000/a/b'
```

- é…ç½®æˆ‘ä»¬çš„package.jsonçš„æ‰§è¡Œè„šæœ¬

```js
"scripts":Â {Â Â Â Â 
    "serve":Â "vue-cli-serviceÂ serveÂ --modeÂ dev",Â Â Â Â 
    "build:test":Â "vue-cli-serviceÂ buildÂ --modeÂ build_test",Â Â Â Â 
    "build:prod":Â "vue-cli-serviceÂ buildÂ --modeÂ build_prod"Â Â 
}
```

å½“æˆ‘ä»¬æ‰§è¡Œ yarn serve / npm run serve å°±ä¼šä½¿ç”¨åˆ° .env.dev é‡Œé¢çš„é…ç½®äº†ï¼Œæ‰§è¡Œå…¶ä»–çš„ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥åœ¨axiosæˆ–è€…fetché…ç½®è¯·æ±‚çš„å‰ç¼€äº†ï¼Œè¯·æ³¨æ„ï¼Œåœ¨å®¢æˆ·ç«¯ä¾§ä»£ç ä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼ˆå¦‚æˆ‘ä»¬çš„è¯·æ±‚åœ°å€ï¼‰ï¼Œåªæœ‰ä»¥ VUE_APP_ å¼€å¤´çš„å˜é‡æ‰å¯ä»¥è¢«è¯»å–åˆ°ï¼Œè¿™äº›éƒ½æ˜¯æ–‡æ¡£ä¸­æ˜ç¡®è¯´æ˜çš„

```js
importÂ axiosÂ fromÂ "axios";
constÂ serviceÂ =Â axios.create({Â Â 
    //Â å½“å‰å¯ä»¥åœ¨æ­¤å¤„è®¿é—®åˆ°.env*æ–‡ä»¶çš„Â VUE_APP_BASE_APIÂ Â 
    baseURL:Â process.env.VUE_APP_BASE_API
});
```

##  é…ç½®vue.config.jsåšä¸€äº›é…ç½®å’Œä¼˜åŒ–

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º vue.config.js æ–‡ä»¶ï¼Œå°±å¯ä»¥åœ¨é‡Œé¢è¿›è¡Œç›¸å…³é…ç½®äº†ï¼Œå½“ç„¶ï¼Œè¿™åªæ˜¯ç®€å•çš„é…ç½®

```js
module.exportsÂ =Â {
    /**
     * *å¦‚æœæ‚¨æ‰“ç®—åœ¨å­è·¯å¾„ä¸‹éƒ¨ç½²ç«™ç‚¹ï¼Œåˆ™éœ€è¦è®¾ç½®publicPathï¼ŒÂ Â 
     * *ä¾‹å¦‚GitHubÂ Pagesã€‚Â å¦‚æœæ‚¨æ‰“ç®—å°†ç½‘ç«™éƒ¨ç½²åˆ°https://foo.github.io/bar/ï¼ŒÂ Â 
     * *ç„¶åpublicPathåº”è¯¥è®¾ç½®ä¸ºâ€œÂ /Â barÂ /â€ã€‚Â Â 
     * *åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¯·ä½¿ç”¨'/'ï¼Â Â 
     * *è¯¦ç»†ä¿¡æ¯ï¼šhttps://cli.vuejs.org/config/#publicpathÂ Â 
     * */ 
    publicPath:Â "./",Â Â //Â é™æ€èµ„æºè®¿é—®Â Â 
    outputDir:Â "dist",Â //Â æ‰“åŒ…è¾“å‡ºè·¯å¾„Â Â 
    productionSourceMap:Â false,Â //Â æ˜¯å¦ç”ŸæˆSourceMapæ–‡ä»¶å®šä½é”™è¯¯ï¼ˆæ–‡ä»¶ä¼šæ¯”è¾ƒå¤šå½±å“æ€§èƒ½å»ºè®®å–æ¶ˆï¼‰Â Â 
    //Â é…ç½®å¼€å‘ç¯å¢ƒçš„ä»£ç†ç”¨æ¥è§£å†³è·¨åŸŸæƒ…å†µï¼Œæ³¨æ„Â devServerÂ åªåœ¨å¼€å‘ç¯å¢ƒæœ‰æ•ˆï¼Œæ‰“åŒ…ä»¥åå‡ºç°çš„è·¨åŸŸæƒ…å†µå¯ç”±åç«¯å’Œnginxåå‘ä»£ç†è§£å†³Â Â 
    devServer:Â {Â Â Â Â 
        port:Â 4000,Â Â Â Â 
        proxy:Â {Â Â Â Â Â Â 
            "/":Â {Â Â Â Â Â Â Â Â 
                target:Â process.env.VUE_APP_BASE_API,Â Â Â Â Â Â Â Â 
                pathRewrite:Â {Â Â Â Â Â Â Â Â Â Â 
                    "^/":Â "/"Â Â Â Â Â Â Â Â 
                }Â Â Â Â Â Â 
            }Â Â Â Â 
        }Â Â 
    }
}
```

## åœ¨ configureWebpack å’Œ chainWebpack ä¸­è¿›è¡Œç›¸å…³çš„é…ç½®

- é¦–å…ˆå¯¹äºå¸¸ç”¨çš„è·¯å¾„æˆ‘æƒ³ä½ ä¸å¸Œæœ›çœ‹åˆ°ç»„ä»¶å¾ˆæ·±çš„æ—¶å€™éœ€è¦ç”¨åˆ°æŸä¸ªèµ„æºå°±å‡ºç° ../../../utils/index.js è¿™ç§æƒ…å†µå§ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é…ç½® configureWebpack ä¸­çš„aliasï¼Œä»¥åè®¿é—®åªéœ€è¦ @/utils/index.js æ›¿ä»£äº†ï¼Œå¯ä»¥è¿™ä¹ˆè¯´ï¼Œæ­¤æ—¶çš„ '../../../  ===  @'ï¼Œæ˜¯ä¸æ˜¯å¾ˆèµå¿ƒæ‚¦ç›®

```js
//Â åœ¨Â module.exportsÂ å¯¼å‡ºå¯¹è±¡ä¸­
configureWebpack:{Â Â 
    resolve:Â {Â Â Â Â 
        alias:Â {Â Â Â Â Â Â 
            '@':Â path.join(__dirname,Â 'src')Â Â Â Â 
        }Â Â 
    }
}
```

- åº”è¯¥å¾ˆå¤šäººä¸å¤ªä¹ æƒ¯debugå§ï¼Œå¤§éƒ½æ˜¯consoleæ»¡å¤©é£ï¼Œå¦‚æœæˆ‘ä»¬è¦è§£å†³æ‰“åŒ…ä»¥åæ¶ˆé™¤é¡¹ç›®ä¸­çš„ consoleï¼Œæ€»ä¸èƒ½ä¸€ä¸ªä¸ªå»æ‰¾ä¸€ä¸ªä¸ªåˆ ï¼Œé‚£å¾—å¤šç´¯äººå•Šï¼Œä¸‡ä¸€ä»¥åè¿˜è¦ç”¨ï¼Œåˆå¾—åŠ ï¼Œå¤šéº»çƒ¦å•Šï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç”¨ä¸Šæˆ‘ä»¬çš„æ’ä»¶äº† terser-webpack-pluginï¼Œè¿™æ ·ä½ åœ¨çº¿ä¸Šçœ‹ä¸åˆ°consoleäº†

```js
//Â yarnÂ addÂ terser-webpack-pluginÂ -D
constÂ TerserPluginÂ =Â require('terser-webpack-plugin');

//Â åœ¨Â module.exportsÂ å¯¼å‡ºå¯¹è±¡ä¸­
configureWebpack:{Â Â 
    optimization:Â {Â Â Â Â Â Â 
        minimizer:Â [Â Â Â Â Â Â Â Â 
            newÂ TerserPlugin({Â Â Â Â Â Â Â Â Â Â 
                terserOptions:Â {Â Â Â Â Â Â Â Â Â Â Â Â 
                    ecma:Â undefined,Â Â Â Â Â Â Â Â Â Â Â Â 
                    warnings:Â false,Â Â Â Â Â Â Â Â Â Â Â Â 
                    parse:Â {},Â Â Â Â Â Â Â Â Â Â Â Â 
                    compress:Â {Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                        drop_console:Â true,Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                        drop_debugger:Â false,Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                        pure_funcs:Â ['console.log']Â //Â ç§»é™¤consoleÂ Â Â Â Â Â Â Â Â Â Â Â 
                    }Â Â Â Â Â Â Â Â Â Â 
                }Â Â Â Â Â Â Â Â 
            })Â Â Â Â Â Â 
        ]Â Â Â 
    }
}
```

- å¯¹äºGzipå‹ç¼©å¤§æ¦‚éƒ½ä¸é™Œç”Ÿï¼Œä½†æ˜¯åœ¨nginxä¸­é…ç½®è¿œè¿œä¸å¤Ÿçš„ï¼Œæˆ‘ä»¬è¿˜å¾—åœ¨æˆ‘ä»¬è‡ªå·±é¡¹ç›®ä¸­åŠ ä¸Šè¿™ä¸ªï¼Œæ‰“åŒ…çš„æ—¶å€™å¯¹é¡¹ç›®è¿›è¡Œgzipå‹ç¼©ï¼Œé…åˆnginxçš„gzipï¼Œåœ¨çº¿ä¸Šç¯å¢ƒçš„æ—¶å€™å¤§å¤§æå‡èµ„æºåŠ è½½é€Ÿåº¦ï¼Œé‚£å°±æ‘†å‡ºæˆ‘ä»¬çš„äºŒå·æ’ä»¶å§ compression-webpack-plugin ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°±éœ€è¦åˆ¤æ–­å•¥ç¯å¢ƒä½¿ç”¨è¯¥æ’ä»¶äº†

```js
//Â yarnÂ addÂ compression-webpack-pluginÂ -D

constÂ CompressionPluginÂ =Â require('compression-webpack-plugin');

constÂ pluginsÂ =Â []

if(process.env.NODE_ENVÂ ===Â 'production'){Â Â 
    plugins.push(newÂ CompressionPlugin({Â Â Â Â Â Â 
        test:Â /\.js$|\.html$|\.css/,Â //Â å¯¹è¯†åˆ«åˆ°çš„æ–‡ä»¶è¿›è¡Œå‹ç¼©Â Â Â Â Â Â 
        threshold:Â 10240,Â //å¯¹è¶…è¿‡10kçš„æ•°æ®å‹ç¼©Â Â Â Â Â Â 
        deleteOriginalAssets:Â falseÂ //ä¸åˆ é™¤æºæ–‡ä»¶ï¼Œå¦‚æœnginxå¼€å¯äº†gzipå¯ä»¥åˆ é™¤Â Â 
    })
)}
//Â åœ¨Â module.exportsÂ å¯¼å‡ºå¯¹è±¡ä¸­
configureWebpack:{
    //Â åœ¨æ­¤å¼•å…¥Â Â 
    plugins:plugins
}
```

è¯´çœŸçš„ï¼Œè¿™ä¸ªæ’ä»¶ç›¸å½“çš„æœ‰ç”¨ï¼ŒçœŸçš„ï¼Œgzipæ˜¾è‘—çš„æå‡äº†èµ„æºåŠ è½½é€Ÿåº¦ï¼Œæ€ä¹ˆè¯´æ¥ç€ï¼Œåœ¨å…¬å¸çš„ç”¨ä½œæµ‹è¯•ç¯å¢ƒçš„åœŸè±†æœåŠ¡å™¨ä¸Šè®¿é—®æœªå¼€å¯gizpçš„é¡¹ç›®ï¼Œå‡ºç°é¦–å±çš„æ—¶é—´æˆ‘è¶³è¶³ç­‰äº†40å¤šsï¼Œä½†æ˜¯å¼€å¯äº†åªéœ€è¦9sï¼Œ9så•Šï¼Œå¿«äº†å¥½å¤šå¥½å¤šäº†

- æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨ chainWebpack ä¸­è¿›è¡Œæ›´ç»†ç²’çš„é…ç½®ï¼Œæ¥ä¸‹æ¥åœ¨ä¸‹æ–¹è´´ä¸Šé…ç½®

```js
chainWebpack(config) {
    // å¯ä»¥æé«˜ç¬¬ä¸€ä¸ªå±å¹•çš„é€Ÿåº¦ï¼Œå»ºè®®æ‰“å¼€é¢„åŠ è½½ï¼Œè¿™å¥è¯ä½¿ä¸Šé¢çš„9sçš„åŠ è½½é€Ÿåº¦é™ä½è‡³7sï¼Œè™½ç„¶ä¸é«˜ï¼Œä½†æ˜¯èšŠå­å†å°ä¹Ÿæ˜¯è‚‰
    config.plugin('preload').tap(() => [
      {
        rel: 'preload',
        fileBlacklist: [/\.map$/, /hot-update\.js$/, /runtime\..*\.js$/],
        include: 'initial'
      }
    ])
    //å½“é¡µé¢å¾ˆå¤šæ—¶ï¼Œå®ƒå°†å¯¼è‡´å¤ªå¤šæ— æ„ä¹‰çš„è¯·æ±‚
    config.plugins.delete('prefetch')
    
    config
      .when(process.env.NODE_ENV !== 'development',
        config => {
          // åªæ‰“åŒ…ç¬¬ä¸‰æ–¹çš„ä¾èµ–
          config
            .plugin('ScriptExtHtmlWebpackPlugin')
            .after('html')
            .use('script-ext-html-webpack-plugin', [{
              inline: /runtime\..*\.js$/
            }])
            .end()
          config
            // ä½¿ç”¨optimization.splitChunksé…ç½®é€‰é¡¹ä¹‹åï¼Œå¯ä»¥ç§»é™¤é‡å¤çš„ä¾èµ–æ¨¡å—ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ’ä»¶å°†ä¸€äº›ç¬¬ä¸‰æ–¹æ¨¡å—åˆ†ç¦»åˆ°å•ç‹¬çš„å—ï¼Œå‡å°äº†ä»£ç çš„ä½“ç§¯ï¼Œå¯ä»¥æŸ¥çœ‹distæ–‡ä»¶ä¸­æ–‡ä»¶å—çš„ä½“ç§¯
            .optimization.splitChunks({
              chunks: 'all',
              cacheGroups: {
                libs: {
                  name: 'chunk-libs', 
                  test: /[\\/]node_modules[\\/]/,
                  priority: 10,
                  chunks: 'initial'
                },
                antdUI: {
                  name: 'chunk-antdUI', // æˆ‘è¿™è¾¹ç”¨çš„antdv å°†antdvåˆ‡å‰²æˆä¸€ä¸ªåŒ…
                  priority: 20,
                  test: /[\\/]node_modules[\\/]_?ant-design-vue(.*)/ 
                }
              }
            })
            
          // https:// webpack.js.org/configuration/optimization/#optimizationruntimechunk
          config.optimization.runtimeChunk('single')
        }
      )
  }
```

